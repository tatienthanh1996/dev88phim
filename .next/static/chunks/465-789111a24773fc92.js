"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{7043:function(e,t,n){var r=n(5893),s=n(1664),a=n.n(s),i=n(9583),l=n(229),o=function(){return(0,r.jsxs)("div",{className:"flex justify-between items-center my-7",children:[(0,r.jsx)(a(),{href:"/",children:(0,r.jsxs)("a",{className:"flex items-center gap-2",children:[(0,r.jsx)("img",{className:"w-25 h-10",src:"https://odetv.vn/images/common/headerLogo.svg",alt:""}),(0,r.jsx)("span",{className:"text-xl font-medium"})]})}),(0,r.jsx)(a(),{href:"/search",children:(0,r.jsx)("a",{className:"block md:hidden",children:(0,r.jsx)(i.U41,{className:"w-6 h-6"})})}),(0,r.jsx)("div",{className:"max-w-[500px] hidden md:block",children:(0,r.jsx)(l.Z,{})})]})};t.Z=o},229:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(7568),s=n(655),a=n(5893),i=n(4184),l=n.n(i),o=n(1664),c=n.n(o),u=n(1163),d=n(7294),h=n(9583),m=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent},x=n(1278),f=function(e){var t=e.autoFocus,n=(0,d.useState)(""),i=n[0],o=n[1],f=(0,d.useState)([]),p=f[0],v=f[1],g=(0,d.useRef)(null),j=(0,u.useRouter)(),w=x.S.useMutation("search.keywords").mutateAsync;(0,d.useEffect)(function(){g.current&&clearTimeout(g.current),v([]),i.trim()&&(g.current=setTimeout((0,r.Z)(function(){var e;return(0,s.__generator)(this,function(e){switch(e.label){case 0:return[4,w({keyword:i.trim()})];case 1:return v(e.sent().map(function(e){return m(e)})),[2]}})}),500))},[i,w]);var y=function(e){e.preventDefault(),i.trim()&&j.push({pathname:"/search",query:{q:i.trim()}})};return(0,a.jsxs)("div",{className:"relative group w-full",children:[(0,a.jsxs)("form",{onSubmit:y,className:"relative",children:[(0,a.jsx)("input",{value:i,onKeyDown:function(e){return e.stopPropagation()},onKeyUp:function(e){return e.stopPropagation()},onKeyPress:function(e){return e.stopPropagation()},onChange:function(e){return o(e.target.value)},className:"bg-transparent outline-none border border-gray-600 w-full rounded-full py-2 pl-4 pr-8",type:"text",placeholder:"Search...",autoFocus:t}),(0,a.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:(0,a.jsx)(h.U41,{className:"w-5 h-5"})})]}),p.length>0&&(0,a.jsx)("div",{className:"absolute z-10 top-full left-0 w-full bg-dark-lighten rounded overflow-x-hidden overflow-y-auto max-h-[200px] flex-col items-stretch hidden group-focus-within:flex",children:p.map(function(e,t){return(0,a.jsx)(c(),{href:{pathname:"/search",query:{q:e}},children:(0,a.jsx)("a",{className:l()("text-left p-2 w-full",{"border-b border-gray-500":t!==p.length-1}),children:e})},t)})})]})}},9114:function(e,t,n){var r=n(1799),s=n(9396),a=n(9534),i=n(5893),l=n(2679),o=n(8769),c=function(e){var t=e.src,n=e.width,c=e.height,u=(0,a.Z)(e,["src","width","height"]);return(0,i.jsx)(l.LazyLoadImage,(0,s.Z)((0,r.Z)({},u),{src:(0,o.t)(t,n,c),width:n,height:c,effect:"opacity"}))};t.Z=c},6089:function(e,t,n){var r=n(5893),s=n(9008),a=n.n(s),i=function(e){var t=e.title,n=e.description,s=e.image;return(0,r.jsxs)(a(),{children:[(0,r.jsx)("title",{children:t}),(0,r.jsx)("meta",{name:"title",content:t}),(0,r.jsx)("meta",{name:"description",content:n}),(0,r.jsx)("meta",{property:"og:type",content:"website"}),(0,r.jsx)("meta",{property:"og:title",content:t}),(0,r.jsx)("meta",{property:"og:description",content:n}),(0,r.jsx)("meta",{property:"og:image",content:s}),(0,r.jsx)("meta",{property:"twitter:card",content:"summary_large_image"}),(0,r.jsx)("meta",{property:"twitter:title",content:t}),(0,r.jsx)("meta",{property:"twitter:description",content:n}),(0,r.jsx)("meta",{property:"twitter:image",content:s})]})};t.Z=i},588:function(e,t,n){n.d(t,{Z:function(){return C}});var r=n(1799),s=n(9396),a=n(5893),i=n(5152),l=n.n(i),o=n(7294),c=n(1278),u=n(7043),d=n(7568),h=n(828),m=n(655),x=n(4184),f=n.n(x),p=n(1131),v=n(1664),g=n.n(v),j=n(9583),w=n(8135),y=n(6032),N=function(e){var t={year:94608e7,month:2592e6,week:6048e5,day:864e5,hour:36e5,minute:6e4},n=Date.now()-new Date(e).getTime();for(var r in t)if(n>=t[r]){var s=Math.floor(n/t[r]);return"".concat(s," ").concat(1===s?r:r+"s"," ago")}return"Just now"},b=n(9114),k=function(e){var t,n,r,s,i,l,c,u,x,v,k,S,Z,_,L=e.data,C=e.episodeIndex,I=(0,h.Z)((0,p.KO)(w.L),1)[0],E=(0,o.useState)(""),F=E[0],P=E[1],U=(0,o.useState)(!1),K=U[0],R=U[1],q="".concat(void 0===C?"movie":"tv","-").concat(L.id),D=(n=(0,d.Z)(function(){var e,t,n;return(0,m.__generator)(this,function(r){switch(r.label){case 0:return[4,y.O.from("comments").select("*,user(*),reactions(*)").eq("movie_slug",q).order("created_at",{ascending:!1})];case 1:if(t=(e=r.sent()).data,n=e.error)throw console.log(n),n;return[2,t]}})}),s=(r=(0,o.useState)(null))[0],i=r[1],c=(l=(0,o.useState)(!s))[0],u=l[1],v=(x=(0,o.useState)(null))[0],k=x[1],S=function(){return n(q).then(function(e){i(e),u(!1),k(!1)}).catch(function(e){i(null),u(!1),k(e)})},(0,o.useEffect)(function(){S()},[q]),{data:s,loading:c,error:v,mutate:S}),M=D.data,V=D.error,O=D.loading,T=D.mutate,A=(Z=(0,d.Z)(function(e){var t;return(0,m.__generator)(this,function(n){switch(n.label){case 0:if(e.preventDefault(),!(F.trim()||!(null==I?void 0:I.id)))return[3,3];return R(!0),P(""),[4,y.O.from("comments").insert({user:null==I?void 0:I.id,content:F.trim().slice(0,1e3),movie_slug:q})];case 1:return t=n.sent().error,console.log(t),[4,T()];case 2:n.sent(),R(!1),n.label=3;case 3:return[2]}})}),function(e){return Z.apply(this,arguments)}),J=(_=(0,d.Z)(function(e,t){return(0,m.__generator)(this,function(n){switch(n.label){case 0:if(!(null==I?void 0:I.id))return[2];return[4,y.O.from("reactions").upsert({user:I.id,comment:e,value:t})];case 1:return n.sent(),T(),[2]}})}),function(e,t){return _.apply(this,arguments)});return(0,a.jsxs)("div",{className:"max-w-[92vw] md:max-w-[calc(88vw-300px)]",children:[(0,a.jsx)("h1",{className:"text-2xl mt-10",children:"Comments"}),V?(0,a.jsx)("div",{className:"my-3",children:"Cannot load comments"}):(0,a.jsxs)(a.Fragment,{children:[I?(0,a.jsxs)("form",{onSubmit:A,className:"relative border border-gray-600 rounded-full my-6",children:[(0,a.jsx)("div",{className:"w-[30px] h-[30px] absolute top-1/2 -translate-y-1/2 left-[10px]",children:(0,a.jsx)(b.Z,{src:I.user_metadata.avatar_url,width:30,height:30,className:"rounded-full",alt:""})}),(0,a.jsx)("input",{value:F,onChange:function(e){return P(e.target.value)},onKeyDown:function(e){return e.stopPropagation()},onKeyUp:function(e){return e.stopPropagation()},onKeyPress:function(e){return e.stopPropagation()},className:"w-full h-12 bg-transparent outline-none text-white px-12",placeholder:"Comment what you think...",maxLength:1e3,type:"text"}),K?(0,a.jsx)("div",{className:"absolute right-[14px] top-1/2 -translate-y-1/2",children:(0,a.jsx)("div",{className:"w-[25px] h-[25px] rounded-full border-white border-t-transparent border-[3px] animate-spin"})}):(0,a.jsx)("button",{className:"absolute right-[14px] top-1/2 -translate-y-1/2",type:"submit",children:(0,a.jsx)(j.Y2X,{className:"w-5 h-5"})})]}):(0,a.jsxs)("div",{className:"flex items-center gap-3 h-12 border border-gray-600 rounded-full my-6 px-3",children:[(0,a.jsx)("img",{className:"w-[30px] h-[30px] rounded-full",src:"/default-avatar.png",alt:""}),(0,a.jsxs)("p",{children:["You need to"," ",(0,a.jsx)(g(),{href:"/sign-in",children:(0,a.jsx)("a",{className:"text-primary",children:"Sign in"})})," ","to comment"]})]}),(0,a.jsx)("div",{className:"flex flex-col items-stretch gap-3 w-full",children:null==M?void 0:M.map(function(e){return(0,a.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,a.jsx)(b.Z,{className:"rounded-full flex-shrink-0",src:e.user.photo_url,width:50,height:50,alt:""}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,a.jsx)("p",{className:"font-bold",children:e.user.display_name}),(0,a.jsx)("p",{className:"text-gray-400 text-sm",children:N(e.created_at)})]}),(0,a.jsx)("p",{style:{wordWrap:"break-word",overflowWrap:"break-word"},children:e.content}),(0,a.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,a.jsxs)("button",{onClick:function(){return J(e.id,e.reactions.some(function(e){return e.user===(null==I?void 0:I.id)&&1===e.value})?0:1)},className:f()("flex items-center gap-1 transition",{"cursor-default":!I,"hover:brightness-75":I,"text-primary":e.reactions.some(function(e){return e.user===(null==I?void 0:I.id)&&1===e.value})}),children:[(0,a.jsx)(j.spm,{className:"fill-current"}),(0,a.jsx)("span",{children:e.reactions.filter(function(e){return 1===e.value}).length})]}),(0,a.jsxs)("button",{onClick:function(){return J(e.id,e.reactions.some(function(e){return e.user===(null==I?void 0:I.id)&&2===e.value})?0:2)},className:f()("flex items-center gap-1 transition",{"cursor-default":!I,"hover:brightness-75":I,"text-primary":e.reactions.some(function(e){return e.user===(null==I?void 0:I.id)&&2===e.value})}),children:[(0,a.jsx)(j.bGJ,{className:"fill-current"}),(0,a.jsx)("span",{children:e.reactions.filter(function(e){return 2===e.value}).length})]})]})]})]},e.id)})}),!O&&(null==M?void 0:M.length)===0&&(0,a.jsx)("p",{className:"text-center text-gray-400",children:"No one has commented"})]})]})},S=n(1163),Z=function(e){var t,n=e.data,i=e.episodeIndex,l=(0,S.useRouter)(),c=(0,o.useRef)(null),u=(0,o.useState)(!1),d=u[0],h=u[1],m=(0,o.useState)(!1),x=m[0],p=m[1];return(0,o.useEffect)(function(){p(!1),c.current&&c.current.offsetTop>0&&h(!0)},[l.asPath]),(0,a.jsxs)("div",{className:"flex flex-col gap-[10px]",children:[(0,a.jsx)("h1",{className:"text-3xl mt-5",children:null==n?void 0:n.name}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("img",{className:"w-4 h-4",src:"/star.png",alt:""}),(0,a.jsx)("p",{children:null==n?void 0:null===(t=n.score)||void 0===t?void 0:t.toFixed(1)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("img",{className:"w-4 h-4",src:"/calendar.png",alt:""}),(0,a.jsx)("p",{children:null==n?void 0:n.year})]})]}),(0,a.jsx)("div",{className:"flex gap-3 flex-wrap",children:n.tagList.map(function(e){return(0,a.jsx)("span",{className:"bg-dark-lighten rounded-full px-3 py-1",children:e.name},e.id)})}),(0,a.jsx)("p",{children:n.introduction}),n.episodeVo>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-xl my-3",children:"Episodes"}),(0,a.jsx)("div",{className:f()("flex flex-wrap gap-3 relative",{"before:absolute before:bg-gradient-to-b before:from-[#00000000] before:to-dark before:top-10 before:w-full before:left-0 before:h-8 max-h-[68px] overflow-hidden":d&&!x}),children:Array(n.episodeVo).fill("").map(function(e,t){return(0,a.jsx)(g(),{prefetch:!1,href:"/tv/".concat(n.id,"/").concat(t),children:(0,a.jsx)("a",(0,s.Z)((0,r.Z)({},t===n.episodeVo-1?{ref:c}:{}),{className:f()("px-4 h-[42px] flex items-center bg-dark-lighten rounded hover:brightness-125 transition duration-300",{"!bg-primary text-white":t===i}),children:t+1}))},t)})}),d&&(0,a.jsx)("div",{children:(0,a.jsx)("button",{className:"text-primary",onClick:function(){return p(!x)},children:x?"Show less":"Show more"})})]})]})},_=function(e){var t=e.data;return(0,a.jsxs)("div",{className:"flex-shrink-0 md:w-[300px]",children:[(null==t?void 0:t.refList)&&t.refList.filter(function(e){return e.id!==t.id}).length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-2xl my-3",children:"In the series"}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-x-hidden overflow-y-auto flex flex-col items-stretch gap-2",children:null==t?void 0:t.refList.filter(function(e){return e.id!==t.id}).map(function(e){return(0,a.jsx)(g(),{href:"/".concat(0===e.category?"movie":"tv","/").concat(e.id),children:(0,a.jsxs)("a",{className:"flex gap-3 pr-2 hover:brightness-[85%] transition duration-300",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-[100px] w-[70px]",children:(0,a.jsx)(b.Z,{height:100,width:70,className:"h-full w-full object-cover",src:e.coverVerticalUrl,alt:""})}),(0,a.jsx)("div",{className:"my-2 flex-grow",children:(0,a.jsx)("p",{children:e.name})})]})},e.id)})})]}),(null==t?void 0:t.likeList)&&t.likeList.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{className:"text-2xl my-3",children:"Similar to this"}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-x-hidden overflow-y-auto flex flex-col items-stretch gap-2",children:null==t?void 0:t.likeList.map(function(e){var t;return(0,a.jsx)(g(),{href:"/".concat(0===e.category?"movie":"tv","/").concat(e.id),children:(0,a.jsxs)("a",{className:"flex gap-3 pr-2 hover:brightness-[85%] transition duration-300",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-[100px] w-[70px]",children:(0,a.jsx)(b.Z,{width:70,height:100,className:"h-full w-full object-cover",src:e.coverVerticalUrl,alt:""})}),(0,a.jsxs)("div",{className:"my-2 flex-grow",children:[(0,a.jsx)("p",{children:e.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("img",{className:"w-4 h-4",src:"/star.png",alt:""}),(0,a.jsx)("p",{children:null===(t=e.score)||void 0===t?void 0:t.toFixed(1)})]})]})]})},e.id)})})]})]})},L=l()(function(){return Promise.all([n.e(27),n.e(655),n.e(932)]).then(n.bind(n,4932))},{loadableGenerated:{webpack:function(){return[4932]}},ssr:!1}),C=function(e){var t=e.data,n=e.sources,i=e.subtitles,l=e.episodeIndex,d="".concat(void 0===l?"movie":"tv","-").concat(null==t?void 0:t.id).concat(l?"-".concat(l):""),h=(0,o.useState)(!1),m=h[0],x=h[1],f=c.S.useQuery(["video.info",{id:t.id,category:void 0===l?0:1,episodeIndex:l},],{enabled:m}).data;return(0,o.useEffect)(function(){if(!window.xhrModified){var e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,n,r,s,a){var i=this;return"string"==typeof n&&n.includes("m3u8")&&(this.addEventListener("error",function(){x(!0)}),this.addEventListener("loadend",function(){i.status>=300&&x(!0)})),e.call(this,t,n,r,s,a)},window.xhrModified=!0}},[]),(0,o.useEffect)(function(){if(t){var e=JSON.parse(localStorage.getItem("filmhot-recent")||"[]");Array.isArray(e)&&((e=e.filter(function(e){return e.id!==t.id})).unshift({id:t.id,category:t.category,coverVerticalUrl:t.coverVerticalUrl,name:t.name}),localStorage.setItem("filmhot-recent",JSON.stringify(e)))}},[t]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"mx-[4vw] lg:mx-[6vw] flex-1",children:[(0,a.jsx)(u.Z,{}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-10 my-7",children:[(0,a.jsxs)("div",{className:"flex flex-col items-stretch flex-grow",children:[(0,a.jsx)("div",{className:"w-full h-0 pb-[56.25%] relative",children:(0,a.jsx)("div",{className:"absolute inset-0 w-full h-full bg-black",children:(0,a.jsx)(L,{playerKey:d,primaryColor:"#0D90F3",src:(null==f?void 0:f.sources)||n,subtitles:(null==i?void 0:i.map(function(e){return(0,s.Z)((0,r.Z)({},e),{url:"/api/subtitle?url=".concat(encodeURIComponent(e.url))})}))||[]},d)})}),(0,a.jsx)(Z,{data:t,episodeIndex:l}),(0,a.jsx)(k,{data:t,episodeIndex:l})]}),(0,a.jsx)(_,{data:t})]})]})})})}},8769:function(e,t,n){n.d(t,{G:function(){return r},t:function(){return s}});var r={0:{width:200,height:100},1:{width:175,height:246}},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"https://images.weserv.nl/?url=".concat(encodeURIComponent(e),"&w=").concat(t,"&h=").concat(n,"&fit=cover&output=webp")}},1278:function(e,t,n){n.d(t,{S:function(){return r}});var r=(0,n(7883).x3)()}}]);